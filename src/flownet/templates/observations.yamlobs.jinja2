smry:
 {%- for well_name in schedule.get_wells(kw_class="WCONHIST") -%}
   {%- if (error_config.WOPR.rel_error is not none) and (error_config.WOPR.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="oil_rate", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WOPR:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.oil_rate }}
      error: {{ [error_config.WOPR.rel_error * kw.oil_rate, error_config.WOPR.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WGPR.rel_error is not none) and (error_config.WGPR.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="gas_rate", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WGPR:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.gas_rate }}
      error: {{ [error_config.WGPR.rel_error * kw.gas_rate, error_config.WGPR.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WWPR.rel_error is not none) and (error_config.WWPR.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="water_rate", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WWPR:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.water_rate }}
      error: {{ [error_config.WWPR.rel_error * kw.water_rate, error_config.WWPR.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WSPR.rel_error is not none) and (error_config.WSPR.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="salt_rate", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WSPR:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.salt_rate }}
      error: {{ [error_config.WSPR.rel_error * kw.salt_rate, error_config.WSPR.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WOPT.rel_error is not none) and (error_config.WOPT.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="oil_total", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WOPT:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.oil_total }}
      error: {{ [error_config.WOPT.rel_error * kw.oil_total, error_config.WOPT.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WWPT.rel_error is not none) and (error_config.WWPT.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="water_total", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WWPT:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.water_total }}
      error: {{ [error_config.WWPT.rel_error * kw.water_total, error_config.WWPT.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WGPT.rel_error is not none) and (error_config.WGPT.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="gas_total", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WGPT:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.gas_total }}
      error: {{ [error_config.WGPT.rel_error * kw.gas_total, error_config.WGPT.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WSPT.rel_error is not none) and (error_config.WSPT.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="salt_total", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WSPT:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.salt_total }}
      error: {{ [error_config.WSPT.rel_error * kw.salt_total, error_config.WSPT.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WBHP.rel_error is not none) and (error_config.WBHP.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="bhp", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WBHP:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.bhp }}
      error: {{ [error_config.WBHP.rel_error * kw.bhp, error_config.WBHP.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WTHP.rel_error is not none) and (error_config.WTHP.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="thp", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WTHP:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.thp }}
      error: {{ [error_config.WTHP.rel_error * kw.thp, error_config.WTHP.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
{%- endfor -%}

{% for well_name in schedule.get_wells(kw_class="WCONINJH") %}
   {%- if (error_config.WBHP.rel_error is not none) and (error_config.WBHP.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONINJH", well_name=well_name, ignore_nan="bhp", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WBHP:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.bhp }}
      error: {{ [error_config.WBHP.rel_error * kw.bhp, error_config.WBHP.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WTHP.rel_error is not none) and (error_config.WTHP.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONINJH", well_name=well_name, ignore_nan="thp", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WTHP:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.bhp }}
      error: {{ [error_config.WTHP.rel_error * kw.thp, error_config.WTHP.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WGIR.rel_error is not none) and (error_config.WGIR.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONINJH", well_name=well_name, ignore_nan="rate", dates=dates[num_beginning_date:num_end_date]) if kw.inj_type == "GAS" -%}
   {% if loop.first and not loop.last: %}
 - key: WGIR:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.rate }}
      error: {{ [error_config.WGIR.rel_error * kw.rate, error_config.WGIR.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WWIR.rel_error is not none) and (error_config.WWIR.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONINJH", well_name=well_name, ignore_nan="rate", dates=dates[num_beginning_date:num_end_date]) if kw.inj_type == "WATER" -%}
   {% if loop.first and not loop.last: %}
 - key: WWIR:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.rate }}
      error: {{ [error_config.WWIR.rel_error * kw.rate, error_config.WWIR.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WGIT.rel_error is not none) and (error_config.WGIT.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONINJH", well_name=well_name, ignore_nan="total", dates=dates[num_beginning_date:num_end_date]) if kw.inj_type == "GAS" -%}
   {% if loop.first and not loop.last: %}
 - key: WGIT:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.total }}
      error: {{ [error_config.WGIT.rel_error * kw.total, error_config.WGIT.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WWIT.rel_error is not none) and (error_config.WWIT.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONINJH", well_name=well_name, ignore_nan="total", dates=dates[num_beginning_date:num_end_date]) if kw.inj_type == "WATER" -%}
   {% if loop.first and not loop.last: %}
 - key: WWIT:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.total }}
      error: {{ [error_config.WWIT.rel_error * kw.total, error_config.WWIT.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WSIR.rel_error is not none) and (error_config.WSIR.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONINJH", well_name=well_name, ignore_nan="rate", dates=dates[num_beginning_date:num_end_date]) if kw.inj_type == "WATER" -%}
   {% if loop.first and not loop.last: %}
 - key: WSIR:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.rate }}
      error: {{ [error_config.WSIR.rel_error * kw.rate, error_config.WSIR.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}
   {%- endfor %}
   {%- endif -%}
   {%- if (error_config.WSIT.rel_error is not none) and (error_config.WSIT.min_error is not none) -%}
   {%- for kw in schedule.get_keywords(kw_class="WCONHIST", well_name=well_name, ignore_nan="salt_total", dates=dates[num_beginning_date:num_end_date]) -%}
   {% if loop.first and not loop.last: %}
 - key: WSIT:{{ well_name }}
   observations:
   {%- endif %}
    - date: {{ kw.date.strftime('%Y-%m-%d') }}
      value: {{ kw.salt_total }}
      error: {{ [error_config.WSIT.rel_error * kw.salt_total, error_config.WSIT.min_error] | max }}
      comment:
        {%- if (kw.date > last_training_date) -%}
        {{ " Test" }}
        {%- else -%}
        {{ " Training" }}
        {%- endif -%}      
   {%- endfor %}
   {%- endif -%}
 {%- endfor -%}
