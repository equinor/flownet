

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>flownet.ahm._run_ahm module &mdash; FlowNet  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/configsuite_ext.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/configsuite_ext.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="flownet.config_parser package" href="flownet.config_parser.html" />
    <link rel="prev" title="flownet.ahm._assisted_history_matching module" href="flownet.ahm._assisted_history_matching.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #eeeeee" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/flownet_logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration_file.html">Configuration file example</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">FlowNet Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html#flownet-package">flownet package</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About FlowNet</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FlowNet</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="api.html">FlowNet Python API</a> &raquo;</li>
        
          <li><a href="flownet.ahm.html">flownet.ahm package</a> &raquo;</li>
        
      <li>flownet.ahm._run_ahm module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/flownet.ahm._run_ahm.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-flownet.ahm._run_ahm">
<span id="flownet-ahm-run-ahm-module"></span><h1>flownet.ahm._run_ahm module<a class="headerlink" href="#module-flownet.ahm._run_ahm" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="flownet.ahm._run_ahm._constrain_using_well_logs">
<code class="sig-prename descclassname"><span class="pre">flownet.ahm._run_ahm.</span></code><code class="sig-name descname"><span class="pre">_constrain_using_well_logs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">porv_poro_trans_dist_values:</span> <span class="pre">pandas.core.frame.DataFrame</span></em>, <em class="sig-param"><span class="pre">data:</span> <span class="pre">numpy.ndarray</span></em>, <em class="sig-param"><span class="pre">network:</span> <span class="pre">flownet.network_model._network_model.NetworkModel</span></em>, <em class="sig-param"><span class="pre">measurement_type:</span> <span class="pre">str</span></em>, <em class="sig-param"><span class="pre">config:</span> <span class="pre">&lt;property</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7fed299e60b0&gt;</span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">pandas.core.frame.DataFrame</span><a class="headerlink" href="#flownet.ahm._run_ahm._constrain_using_well_logs" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to constrain permeability and porosity distributions of flow tubes by using 3D kriging of
porosity and permeability values from well logs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>porv_poro_trans_dist_values</strong> – pre-constraining dataframe</p></li>
<li><p><strong>data</strong> – well log data</p></li>
<li><p><strong>network</strong> – FlowNet network model</p></li>
<li><p><strong>measurement_type</strong> – ‘prorosity’ or ‘permeability’ (always log10)</p></li>
<li><p><strong>config</strong> – FlowNet configparser snapshot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Well-log constrained “porv_poro_trans_dist_values” DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="flownet.ahm._run_ahm._find_training_set_fraction">
<code class="sig-prename descclassname"><span class="pre">flownet.ahm._run_ahm.</span></code><code class="sig-name descname"><span class="pre">_find_training_set_fraction</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">schedule:</span> <span class="pre">flownet.realization._schedule.Schedule</span></em>, <em class="sig-param"><span class="pre">config:</span> <span class="pre">&lt;property</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7fed299e60b0&gt;</span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="headerlink" href="#flownet.ahm._run_ahm._find_training_set_fraction" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schedule</strong> – FlowNet Schedule instance</p></li>
<li><p><strong>config</strong> – Information from the FlowNet config yaml</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Fraction of the observations to be used as a training set</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="flownet.ahm._run_ahm._from_regions_to_flow_tubes">
<code class="sig-prename descclassname"><span class="pre">flownet.ahm._run_ahm.</span></code><code class="sig-name descname"><span class="pre">_from_regions_to_flow_tubes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="flownet.network_model._network_model.html#flownet.network_model._network_model.NetworkModel" title="flownet.network_model._network_model.NetworkModel"><span class="pre">flownet.network_model._network_model.NetworkModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="flownet.data.from_flow.html#flownet.data.from_flow.FlowData" title="flownet.data.from_flow.FlowData"><span class="pre">flownet.data.from_flow.FlowData</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ti2ci</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#flownet.ahm._run_ahm._from_regions_to_flow_tubes" title="Permalink to this definition">¶</a></dt>
<dd><p>The function loops through each cell in all flow tubes, and checks what region the
corresponding position (cell midpoint) in the data source simulation model has. If different
cells in one flow tube are located in different regions of the original model, the mode is used.
If flow tubes are entirely outside of the data source simulation grid, the region of the closest
flow tube which has already been assigned to a region will be used. The distance between two flow
tubes is calculated as the distance between the mid points of the two flow tubes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> – FlowNet network instance</p></li>
<li><p><strong>field_data</strong> – FlowData class with information from simulation model data source</p></li>
<li><p><strong>ti2ci</strong> – A dataframe with index equal to tube model index, and one column which equals cell indices.</p></li>
<li><p><strong>region_name</strong> – The name of the region parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list with values for ‘name’ region for each tube in the FlowNet model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="flownet.ahm._run_ahm._get_distribution">
<code class="sig-prename descclassname"><span class="pre">flownet.ahm._run_ahm.</span></code><code class="sig-name descname"><span class="pre">_get_distribution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">pandas.core.frame.DataFrame</span><a class="headerlink" href="#flownet.ahm._run_ahm._get_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the distribution min, mean, base, stddev, max for one or more parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> – which parameter(s) should be outputted in the dataframe</p></li>
<li><p><strong>parameters_config</strong> – the parameters definition from the configuration file</p></li>
<li><p><strong>index</strong> – listing used to determine how many times to repeat the distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dataframe with distributions for the requested parameter(s)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="flownet.ahm._run_ahm.run_flownet_history_matching">
<code class="sig-prename descclassname"><span class="pre">flownet.ahm._run_ahm.</span></code><code class="sig-name descname"><span class="pre">run_flownet_history_matching</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">config:</span> <span class="pre">&lt;property</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x7fed299e60b0&gt;</span></em>, <em class="sig-param"><span class="pre">args:</span> <span class="pre">argparse.Namespace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#flownet.ahm._run_ahm.run_flownet_history_matching" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates and runs an ERT setup, given user configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – Configsuite parsed user provided configuration.</p></li>
<li><p><strong>args</strong> – Argparse parsed command line arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nothing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="flownet.ahm._run_ahm.update_distribution">
<code class="sig-prename descclassname"><span class="pre">flownet.ahm._run_ahm.</span></code><code class="sig-name descname"><span class="pre">update_distribution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="flownet.parameters._base_parameter.html#flownet.parameters._base_parameter.Parameter" title="flownet.parameters._base_parameter.Parameter"><span class="pre">flownet.parameters._base_parameter.Parameter</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ahm_case</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="flownet.parameters._base_parameter.html#flownet.parameters._base_parameter.Parameter" title="flownet.parameters._base_parameter.Parameter"><span class="pre">flownet.parameters._base_parameter.Parameter</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#flownet.ahm._run_ahm.update_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the prior distribution for one or more parameters based on
the mean and standard deviation of the posterior distribution. It is assumed that the prior min
and max values cannot be exceeded. The type of distribution will also be kept.</p>
<dl class="simple">
<dt>For the distributions with a min/max:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>If the mean value in the posterior is less than in the prior, the minimum value (and the mode) will be kept</dt><dd><p>and the maximum value and the mean will be updated.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If the mean value in the posterior is larger than in the prior, the maximum value (and the mode) will be</dt><dd><p>kept and the minimum value and the mean will be updated.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>For distributions defined by a mean and standard deviation the mean and standard deviation will be updated based
on the values from the posterior</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> – which parameter(s) should be updated</p></li>
<li><p><strong>ahm_case</strong> – path to a previous HM experiment folder</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The parameters list with updated distributions.</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="flownet.config_parser.html" class="btn btn-neutral float-right" title="flownet.config_parser package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="flownet.ahm._assisted_history_matching.html" class="btn btn-neutral float-left" title="flownet.ahm._assisted_history_matching module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Equinor.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>